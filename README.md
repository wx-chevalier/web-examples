
> æœ¬æ–‡ä»å±äºç¬”è€…çš„[Web Frontend Introduction And Best Practices:å‰ç«¯å…¥é—¨ä¸æœ€ä½³å®è·µ](https://github.com/wxyyxc1992/Web-Develop-Introduction-And-Best-Practices/tree/master/Frontend),é¡¹ç›®çš„Githubåœ°å€ä¸º[Webpack2-React-Redux-Boilerplate](https://github.com/wxyyxc1992/Webpack2-React-Redux-Boilerplate).

> Warning!ç¬”è€…è‡ªå·±æ„å»ºçš„åŸºäºWebpack+React+Reduxçš„è„šæ‰‹æ¶å·²ç»ç»å†äº†ä¸‰ä¸ªç‰ˆæœ¬,ä¹‹å‰çš„ä¸¤ä¸ªç‰ˆæœ¬å‚è€ƒ[Webpackå®æˆ˜ä¹‹Quick Start](https://segmentfault.com/a/1190000003873739)ä»¥åŠ[æˆ‘çš„Webpackå¥—è£…](https://segmentfault.com/a/1190000005122575)ã€‚åœ¨æœ¬æ–‡æ–‡é¦–æ­¤å¤„,æˆ‘å¿…é¡»ä¸¥è‚ƒåæ§½ä¸‹,æˆ‘æ·±åˆ»æ„Ÿè§‰åˆ°Boilerplateå°±åƒå½“å¹´çš„Rails,æ–¹ä¾¿å…¥é—¨çš„åŒæ—¶ä¼šç»™ä½ æ— å°½çš„æŸç¼š,å› æ­¤ç¬”è€…ä¸å»ºè®®ä»»ä½•äººåœ¨æ­£å¼é¡¹ç›®ä¸­ç›´æ¥ä½¿ç”¨è‡ªå·±ä¸èƒ½å®Œå…¨æŒæ§çš„è„šæ‰‹æ¶ã€‚æˆ‘è§‰å¾—æˆ‘æ˜¯æ— æ³•å¿˜è®°å½“åˆè¢«[react-redux-universal-hot-example](https://github.com/erikras/react-redux-universal-hot-example)æ”¯é…çš„ææƒ§ã€‚

# Webpack2 React Redux Boilerplate

> æ ¸å¿ƒç»„ä»¶ä»£ç ä¸è„šæ‰‹æ¶ä¹‹é—´åŠ¡å¿…å­˜åœ¨æœ‰æœºåˆ†å‰²ï¼Œæ•´ä¸ªç¨‹åºæ¶æ„æ¸…æ™°æ˜“æ‡‚ã€‚

![](https://coding.net/u/hoteam/p/Cache/git/raw/master/2016/10/2/1-raWO3dhM4jMjf9VY-kZzNg.png)

å¦‚æœä½ æ˜¯å®Œå…¨çš„Reactåˆå­¦è€…,é‚£ä¹ˆå»ºè®®é¦–å…ˆäº†è§£ä¸‹[ä½¿ç”¨Facebookçš„create-react-appå¿«é€Ÿæ„å»ºReactå¼€å‘ç¯å¢ƒ](https://segmentfault.com/a/1190000006055973)ï¼ŒåŒæ—¶å‚è€ƒç¬”è€…çš„[React å…¥é—¨ä¸æœ€ä½³å®è·µ](https://github.com/wxyyxc1992/Web-Develop-Introduction-And-Best-Practices/tree/master/Frontend/Framework/View/React)ä»¥åŠ[Redux å…¥é—¨ä¸æœ€ä½³å®è·µ](https://github.com/wxyyxc1992/Web-Develop-Introduction-And-Best-Practices/tree/master/Frontend/Framework/StateManagement/Redux)ã€‚æœ¬é¡¹ç›®ç®—æ˜¯ä¸ªåŠè‡ªåŠ¨åŒ–çš„è„šæ‰‹æ¶å·¥å…·,ç¬”è€…å¹¶ä¸å¸Œæœ›åšæˆå®Œå…¨å‚»ç“œå¼çš„å¼€ç®±å³ç”¨çš„å·¥å…·,è¿™åªä¼šç»™ä½ çš„é¡¹ç›®åŸ‹ä¸‹å±é™©çš„ä¼ç¬”,å¸Œæœ›æ¯ä¸ªå¯èƒ½ç”¨è¿™ä¸ªBoilerplateçš„åŒå­¦éƒ½èƒ½é˜…è¯»æ–‡æœ¬,è‡³å°‘è¦ä¿è¯å¯¹æ–‡æœ¬æåŠçš„çŸ¥è¯†ç‚¹æœ‰ä¸ªå…¨å±€çš„äº†è§£ã€‚

## Features

æœ¬éƒ¨åˆ†å‡è®¾ä½ å·²ç»å¯¹Webpackæœ‰äº†å¤§æ¦‚çš„äº†è§£ï¼Œè¿™é‡Œæˆ‘ä»¬ä¼šé’ˆå¯¹ç¬”è€…è‡ªå·±åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨çš„Webpackç¼–è¯‘è„šæœ¬è¿›è¡Œçš„ä¸€ä¸ªæ€»ç»“ï¼Œåœ¨ä»‹ç»å…·ä½“çš„é…ç½®æ–¹æ¡ˆä¹‹å‰ç¬”è€…æƒ³å…ˆæ¦‚è¿°ä¸‹è¯¥é…ç½®æ–‡ä»¶çš„è®¾è®¡çš„ç›®æ ‡ï¼Œæˆ–è€…è¯´æ˜¯ç¬”è€…è®¤ä¸ºä¸€ä¸ªå‰ç«¯ç¼–è¯‘ç¯å¢ƒåº”è¯¥è¾¾æˆçš„ç‰¹æ€§ï¼Œè¿™æ ·ä»¥åå³ä½¿Webpackè¢«æ·˜æ±°äº†ä¹Ÿå¯ä»¥åˆ©ç”¨å…¶ä»–çš„è­¬å¦‚JSPMä¹‹ç±»çš„æ¥å®Œæˆç±»ä¼¼çš„å·¥ä½œã€‚

- è€ƒè™‘åˆ°åŒä¸€é¡¹ç›®å¯¹å¤šç¼–è¯‘ç›®æ ‡çš„æ”¯æŒï¼ŒåŒ…æ‹¬å¼€å‘ç¯å¢ƒã€çº¯å‰ç«¯è¿è¡Œç¯å¢ƒï¼ˆåŒ…æ‹¬Cordovaã€APICloudã€Weappè¿™ç§é¢å‘ç§»åŠ¨ç«¯çš„æ–¹æ¡ˆï¼‰ã€åŒæ„ç›´å‡ºç¯å¢ƒï¼Œå¹¶ä¸”ä¿è¯é¡¹ç›®å¯ä»¥åœ¨è¿™ä¸‰ä¸ªç¯å¢ƒä¹‹é—´å¹³æ»‘åˆ‡æ¢ï¼Œåˆç†åˆ†å‰²è„šæ‰‹æ¶å·¥å…·ä¸æ ¸å¿ƒåº”ç”¨ä»£ç ã€‚

- å•ä¸€çš„é…ç½®æ–‡ä»¶ï¼šå¾ˆå¤šé¡¹ç›®é‡Œé¢æ˜¯æŠŠå¼€å‘ç¯å¢ƒä¸ç”Ÿäº§ç¯å¢ƒå†™äº†ä¸¤ä¸ªé…ç½®æ–‡ä»¶ï¼Œå¯èƒ½ç¬”è€…æ¯”è¾ƒæ‡’å§ï¼Œä¸å–œæ¬¢è¿™ä¹ˆåšï¼Œå› æ­¤ç¬”è€…çš„ç¬¬ä¸€ä¸ªç‰¹æ€§å°±æ˜¯å•ä¸€çš„é…ç½®æ–‡ä»¶ï¼Œç„¶åé€šè¿‡npmå°è£…ä¸åŒçš„ç¼–è¯‘å‘½ä»¤ä¼ å…¥ç¯å¢ƒå˜é‡ï¼Œç„¶ååœ¨é…ç½®æ–‡ä»¶ä¸­æ ¹æ®ä¸åŒçš„ç¯å¢ƒå˜é‡è¿›è¡ŒåŠ¨æ€å“åº”ã€‚å¦å¤–ï¼Œè¦ä¿è¯ä¸€ä¸ªBoilerplateèƒ½å¤Ÿåœ¨æœ€å°ä¿®æ”¹çš„æƒ…å†µä¸‹åº”ç”¨åˆ°å…¶ä»–é¡¹ç›®ã€‚

- å¤šåº”ç”¨å…¥å£æ”¯æŒï¼šæ— è®ºæ˜¯å•é¡µåº”ç”¨è¿˜æ˜¯å¤šé¡µåº”ç”¨ï¼Œåœ¨Webpackä¸­å¾€å¾€ä¼šæŠŠä¸€ä¸ªhtmlæ–‡ä»¶ä½œä¸ºä¸€ä¸ªå…¥å£ã€‚ç¬”è€…åœ¨è¿›è¡Œé¡¹ç›®å¼€å‘æ—¶ï¼Œå¾€å¾€ä¼šéœ€è¦é¢å¯¹å¤šä¸ªå…¥å£ï¼Œå³å¤šä¸ªHTMLæ–‡ä»¶ï¼Œç„¶åè¿™ä¸ªHTMLæ–‡ä»¶åŠ è½½ä¸åŒçš„JSæˆ–è€…CSSæ–‡ä»¶ã€‚è­¬å¦‚ç™»å½•é¡µé¢ä¸ä¸»ç•Œé¢ï¼Œå¾€å¾€å¯ä»¥è§†ä½œä¸¤ä¸ªä¸åŒçš„å…¥å£ã€‚WebpackåŸç”Ÿæå€¡çš„é…ç½®æ–¹æ¡ˆæ˜¯é¢å‘è¿‡ç¨‹çš„ï¼Œè€Œç¬”è€…åœ¨è¿™é‡Œæ˜¯é¢å‘åº”ç”¨æ–¹å¼çš„å°è£…é…ç½®ã€‚

- è°ƒè¯•æ—¶çƒ­åŠ è½½ï¼šè¿™ä¸ªç‰¹æ€§æ¯‹åº¸å¤šè¨€ï¼Œä¸è¿‡çƒ­åŠ è½½å› ä¸ºèµ°å¾—æ˜¯ä¸­é—´æœåŠ¡å™¨ï¼ŒåŒæ—¶åªèƒ½æ”¯æŒç›‘å¬ä¸€ä¸ªé¡¹ç›®ï¼Œå› æ­¤éœ€è¦åœ¨å¤šåº”ç”¨é…ç½®çš„æƒ…å†µä¸‹åŠ ä¸Šä¸€ä¸ªå‚æ•°ï¼Œå³æŒ‡å®šå½“å‰è°ƒè¯•çš„åº”ç”¨ã€‚

- è‡ªåŠ¨åŒ–çš„Polyfillï¼šè¿™ä¸ªæ˜¯Webpackè‡ªå¸¦çš„ä¸€ä¸ªç‰¹æ€§å§ï¼Œä¸è¿‡ç¬”è€…å°±åŠ ä»¥æ•´åˆï¼Œä¸»è¦æ˜¯å®ç°äº†å¯¹äºES6ã€Reactã€CSS(Flexbox)ç­‰ç­‰çš„è‡ªåŠ¨Polyfillã€‚

- èµ„æºæ–‡ä»¶çš„è‡ªåŠ¨ç®¡ç†ï¼šè¿™éƒ¨åˆ†ä¸»è¦æŒ‡ä»æ¨¡æ¿è‡ªåŠ¨ç”Ÿæˆç›®æ ‡HTMLæ–‡ä»¶ã€è‡ªåŠ¨å¤„ç†å›¾ç‰‡/å­—ä½“ç­‰èµ„æºæ–‡ä»¶ä»¥åŠè‡ªåŠ¨æå–å‡ºCSSæ–‡ä»¶ç­‰ã€‚

- æ–‡ä»¶åˆ†å‰²ä¸å¼‚æ­¥åŠ è½½ï¼šå¯ä»¥å°†å¤šä¸ªåº”ç”¨ä¸­çš„å…¬å…±æ–‡ä»¶ï¼Œè­¬å¦‚éƒ½å¼•ç”¨äº†Reactç±»åº“çš„è¯ï¼Œå¯ä»¥å°†è¿™éƒ¨åˆ†æ–‡ä»¶æå–å‡ºæ¥ï¼Œè¿™æ ·å‰ç«¯å¯ä»¥å‡å°‘ä¸€å®šçš„æ•°æ®ä¼ è¾“ã€‚å¦å¤–çš„è¯è¿˜éœ€è¦æ”¯æŒç»„ä»¶çš„å¼‚æ­¥åŠ è½½ï¼Œè­¬å¦‚ç”¨äº†React Routerï¼Œé‚£éœ€è¦æ”¯æŒç»„ä»¶åœ¨éœ€è¦æ—¶å†åŠ è½½ã€‚

## çœŸçš„éœ€è¦Reduxå—?

> - [æ€è€ƒ:æˆ‘éœ€è¦æ€æ ·çš„å‰ç«¯çŠ¶æ€ç®¡ç†å·¥å…·?](https://segmentfault.com/a/1190000007103433)
> - [ä½ ä¸ä¸€å®šéœ€è¦Redux](https://segmentfault.com/a/1190000006966262)

è™½ç„¶æœ¬é¡¹ç›®æ˜¯é¢å‘Webpack+React+Reduxçš„Boilerplateï¼Œä½†æ˜¯ç¬”è€…è¿˜æ˜¯å¸Œæœ›åœ¨æ­¤æŠ›å‡ºè¿™ä¸ªé—®é¢˜ï¼Œä¹Ÿæ˜¯ä¾¿äºå¤§å®¶èƒ½å¤Ÿç†è§£Reduxã€‚å¯¹äºè¿™ä¸ªé—®é¢˜ç¬”è€…æ²¡æœ‰æ˜ç¡®çš„ç­”æ¡ˆ,ä½†æ˜¯åœ¨è¿™ä¸¤å¹´çš„è‡ªå·±å¯¹äºReduxçš„å®æˆ˜ä¸­,ä¹Ÿä¸€ç›´åœ¨æ‘‡æŠŠã€‚æˆ‘åšå®šçš„è®¤ä¸ºReduxæŒ‡æ˜äº†è§£å†³æŸç±»é—®é¢˜çš„æ­£ç¡®æ–¹å‘,ä½†æ˜¯å®ƒçœŸçš„é€‚åˆäºæ‰€æœ‰çš„é¡¹ç›®å—?ç¬”è€…åœ¨[æˆ‘çš„å‰ç«¯ä¹‹è·¯](https://segmentfault.com/a/1190000004292245)ä¸€æ–‡ä¸­æåŠ,ä»ä»¥DOMæ“ä½œä¸ºæ ¸å¿ƒçš„jQueryæ—¶ä»£åˆ°ä»¥å£°æ˜å¼ç»„ä»¶ä¸ºæ ¸å¿ƒçš„Reactæ—¶ä»£çš„å˜è¿æ˜¯å£°æ˜å¼ç¼–ç¨‹å¯¹äºå‘½ä»¤å¼çš„æ…¢æ…¢ä»£æ›¿,è€ŒReduxåˆ™æ˜¯çº¯ç²¹çš„å£°æ˜å¼ç¼–ç¨‹å…¸èŒƒã€‚è¿™é‡Œä»¥æŸä¸ªç™»å½•è®¤è¯çš„å°ä¾‹å­è¿›è¡Œè¯´æ˜ï¼Œäº§å“çš„éœ€æ±‚æ˜¯å…è®¸ç”¨æˆ·åœ¨ç™»å½•æˆåŠŸä¹‹ååœ¨ç™»å½•é¡µé¢ä¸Šæ˜¾ç¤ºâ€œç™»å½•æˆåŠŸï¼Œæ­£åœ¨è·³è½¬â€ï¼Œç„¶åå»¶æ—¶è·³è½¬åˆ°å…¶ä»–é¡µé¢ã€‚è¿™é‡Œå¼ºè°ƒè¦åœ¨ç™»å½•é¡µé¢ä¸Šè¿›è¡Œå›æ˜¾æ˜¯å› ä¸ºå¾ˆå¤šäººä¹ æƒ¯å°†ï¼Œè·³è½¬ä½œä¸ºSide Effectåœ¨Thunkæˆ–è€…Sagaä¸­å°±å¤„ç†äº†ï¼Œå¹¶æ²¡æœ‰å½±å“åˆ°ç•Œé¢æœ¬èº«ã€‚å…·ä½“çš„ä»£ç å¯¹æ¯”å¯ä»¥å‚è€ƒ[çº¯ç²¹çš„Reactå®ç°çš„ç™»å½•è·³è½¬](https://github.com/wxyyxc1992/Webpack-React-Redux-Boilerplate/blob/master/src/react/component/login.js)ä¸[åŸºäºReduxå®ç°çš„ç™»å½•è·³è½¬](https://github.com/wxyyxc1992/Webpack-React-Redux-Boilerplate/blob/master/src/redux/container/login.js)ã€‚é¦–å…ˆï¼Œå¦‚æœæ˜¯çº¯ç²¹çš„Reactå‘½ä»¤å¼çš„è¯ï¼Œä¼šæ˜¯:

```
class ReactComponent{
  ...
  if(!isValid){ //isValidæ˜¯å¤–éƒ¨ä¼ å…¥çš„çŠ¶æ€å˜é‡ï¼Œå­˜æ”¾ç”¨æˆ·æ˜¯å¦å·²ç»ç™»å½•
  //å¦‚æœå°šæœªç™»å½•ï¼Œåˆ™è¿›è¡Œç™»å½•æ“ä½œ
  login().then(()=>{
    //ç™»å½•æˆåŠŸä¹‹åï¼Œæ˜¾ç¤ºæ–‡å­—å¹¶ä¸”æ‰§è¡Œè·³è½¬
    show('ç™»å½•æˆåŠŸï¼Œæ­£åœ¨è·³è½¬');
    redirect();
  });
}
}
```

å¦‚æœæˆ‘ä»¬å¼•å…¥Reduxï¼Œå¹¶ä¸”å°†Componentä¸­çš„æ‰€æœ‰å‰¯ä½œç”¨ç§»é™¤çš„è¯:

```
class ReduxComponent{
  ...
  if(!isValid){ 
  	login(); //æ‰§è¡Œç™»å½•æ“ä½œï¼Œå…¶ä¼šdispatchæŸä¸ªActionï¼Œè§¦å‘å¤–éƒ¨çŠ¶æ€å˜åŒ–
  }
  
  if(shouldRedirect){ //éœ€è¦æ·»åŠ è¯¥å˜é‡æ¥è®°å½•æ˜¯å¦éœ€è¦è¿›è¡Œè·³è½¬
    show('ç™»å½•æˆåŠŸï¼Œæ­£åœ¨è·³è½¬');
    dispatch({type:'SET_SHOULDREDIRECT_FALSE'});//å°†æ§åˆ¶æ˜¯å¦è·³è½¬çš„çŠ¶æ€å˜é‡é‡ç½®
    redirect();
  }
}
}
```

ä»ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬èƒ½çœ‹å‡º,å°±å¥½åƒèƒ½é‡å®ˆæ’å®šç†ä¸€æ ·,å¯¹äºä»»ä½•çš„ä¸šåŠ¡é€»è¾‘çš„å®ç°è¦ä¹ˆä»¥å‘½ä»¤çš„æ–¹å¼,è¦ä¹ˆä»¥å£°æ˜çš„æ–¹å¼è¾…ä»¥å¤§é‡çš„çŠ¶æ€å˜é‡ï¼ˆå‚è€ƒåŸºäºå˜é‡çš„å¾ªç¯ä¸åŸºäºè¿­ä»£çš„å¾ªç¯äºŒè€…çš„ä»£ç å¤æ‚åº¦æ¯”è¾ƒï¼‰ã€‚Reduxä»¥å‡½æ•°å¼ç¼–ç¨‹çš„å¼ºçº¦æŸå°†æˆ‘ä»¬å¾ˆå¤šçš„é€»è¾‘æ‹†åˆ†ä¸ºäº†å¤šä¸ªçº¯å‡½æ•°è¡¨ç¤º,å¹¶ä»¥æ•°æ®æµé©±åŠ¨æ•´ä¸ªé¡¹ç›®ã€‚Reduxå…è®¸æˆ‘ä»¬ä»¥æ”¯ç¦»ç ´ç¢çš„é€»è¾‘ä»£ç ä¸ç›¸è¾ƒäºå‘½ä»¤å¼ç¼–ç¨‹è†¨èƒ€å¾ˆå¤šçš„æ¨¡æ¿ä»£ç ä¸ºä»£ä»·å®ç°ç™¾åˆ†ç™¾çš„å¯æµ‹è¯•æ€§ä¸å¯é¢„æµ‹æ€§ã€‚ç»è¿‡è¿™ä¹ˆé•¿æ—¶é—´çš„æ‘¸ç´¢ä¸ç¤¾åŒºå¹¿æ³›çš„è®¨è®ºå®è·µï¼ŒReduxçš„ä¼˜åŠ¿ä¸åŠ£åŠ¿éƒ½å·²ç»å¾ˆæ˜æ˜¾äº†ã€‚å¯¹äºå…·ä½“çš„ä½¿ç”¨è€…ä¹Ÿæ˜¯è§ä»è§æ™ºï¼Œä»¥ç¬”è€…è€Œè¨€å› ä¸ºä¸€ç›´éƒ½åœ¨ä¸­å°å‹ä¼ä¸šä¸­ï¼Œå¾€å¾€å¯¹äºäº§å“è¿›åº¦çš„è¦æ±‚ä¼šå¤šä½™æµ‹è¯•ï¼Œå¹¶ä¸”æ›´å¤šçš„ä»¥äººå·¥æµ‹è¯•ä¸ºä¸»ï¼Œå› æ­¤ç¬”è€…ç›®å‰æ˜¯å°è¯•åœ¨é¡¹ç›®ä¸­æ··ç”¨[MobX](https://github.com/wxyyxc1992/Web-Develop-Introduction-And-Best-Practices/tree/master/OpenSource/mobx-react-webpack-boilerplate)ä¸Reduxï¼Œå¸Œæœ›èƒ½å¤Ÿæœ‰æ•ˆå¹³è¡¡å¼€å‘é€Ÿåº¦ä¸æ•´ä½“çš„é²æ£’æ€§/å¯æ‰©å±•æ€§ã€‚

## Personal Best Practice

æœ¬éƒ¨åˆ†æ˜¯åˆ—ä¸¾ä¸€äº›é€šç”¨çš„ä¸ªäººæœ€ä½³å®è·µçš„æ„Ÿå—ï¼Œä¸å±€é™äºReactæˆ–è€…Reduxã€‚å…·ä½“çš„å…³äºReactä¸Reduxçš„å®è·µå»ºè®®ä¼šåœ¨ä¸‹æ–‡ä¸­ä»‹ç»ã€‚

- Promise

  ä½¿ç”¨Promiseè¿›è¡Œå¼‚æ­¥æ“ä½œï¼Œå»ºè®®ä½¿ç”¨await/asyncä½œä¸ºPromiseè¯­æ³•ç³–æ„å»ºå¼‚æ­¥å‡½æ•°ã€‚

- fetch

  ä½¿ç”¨fetchä½œä¸ºç»Ÿä¸€çš„æ•°æ®è·å–å‡½æ•°ï¼Œåœ¨æœ¬é¡¹ç›®ä¸­ä½¿ç”¨äº†ç¬”è€…çš„[fluent-fetcher]()ä½œä¸ºfetchçš„ä¸Šå±‚å°è£…ä½¿ç”¨ã€‚

- å°½å¯èƒ½å°‘çš„ä½¿ç”¨è¡Œå†…æ ·å¼,å°†æ¯ä¸ªç»„ä»¶çš„æ ·å¼æ–‡ä»¶ä¸ç»„ä»¶å£°æ˜æ–‡ä»¶åŒåœ°å­˜æ”¾
  è­¬å¦‚Material-UIè¿™ä¸ªè‘—åçš„Reactæ ·å¼ç»„ä»¶åº“ä¸[react-redux-universal-hot-example](https://github.com/erikras/react-redux-universal-hot-example)
  ä¹‹å‰çš„ç‰ˆæœ¬éƒ½æ˜¯ç”¨çš„CSS-IN-JavaScript,å…¨éƒ¨å†…è”æ ·å¼ã€‚ç¬”è€…æ„Ÿè§‰è¿˜æ˜¯éœ€è¦å°†CSSä¸JSå‰¥ç¦»å¼€æ¥,ä¸€æ–¹é¢æ˜¯å¤„äºèŒè´£åˆ†å‰²çš„è€ƒè™‘,å¦ä¸€æ–¹é¢ä¹Ÿæ˜¯ä¸ºäº†æ ·å¼çš„å¯å˜æ€§ã€‚é€šè¿‡æ ·å¼ç±»çš„æ–¹å¼æ¥å®šä¹‰æ–¹å¼å¾ˆæ–¹ä¾¿åœ°å¯ä»¥é€šè¿‡CSSæ¥ä¿®æ­£æ ·å¼,è€Œä¸éœ€è¦æ¯æ¬¡éƒ½è¦æ‰¾åŠå¤©å†…è”æ ·å¼åœ¨å“ªé‡Œ,ç„¶åå»é‡æ–°ç¼–è¯‘æ•´ä¸ªé¡¹ç›®ã€‚

- é€‚å½“åˆç†åœ°ç¼–å†™çº¯å‡½æ•°ï¼Œåœ¨åˆç†èŒƒå›´å†…å°½å¯èƒ½åœ°å°†é€»è¾‘å¤„ç†æŠ½è±¡ä¸ºçº¯å‡½æ•°

## Reference

### Boilerplate

- [react-transform-boilerplate](https://github.com/gaearon/react-transform-boilerplate)
- [react-boilerplate](https://github.com/mxstbr/react-boilerplate)
- [react-redux-saga-boilerplate](https://github.com/gilbarbara/react-redux-saga-boilerplate)
- [react-redux-universal-hot-example](https://github.com/erikras/react-redux-universal-hot-example)

### Blogs

- [webpack-for-the-fast-and-the-furious](https://medium.freecodecamp.com/webpack-for-the-fast-and-the-furious-bf8d3746adbd#.poot9r5ee)
- [react-project](https://github.com/ryanflorence/react-project#lazy)



# Quick Start

![](https://coding.net/u/hoteam/p/Cache/git/raw/master/2016/10/2/1-7M1eE4GO6_Lh2c-pmjGkcA.jpeg)

æœ¬éƒ¨åˆ†ç¬”è€…é¦–å…ˆä¼šä»‹ç»æœ¬é¡¹ç›®ä¸­æ‰€æœ‰é¢„ç½®çš„é¡¹ç›®ç¼–è¯‘åŠè¿è¡Œå‘½ä»¤ã€‚é¦–å…ˆéœ€è¦æ˜ç¡®çš„ä¸¤ç‚¹ï¼Œæœ¬Boilerplateæ˜¯å¸Œæœ›è¾¾æˆä»¥ä¸‹ä¸¤ä¸ªç›®æ ‡ï¼š

ï¼ˆ1ï¼‰å°†å…³äºåº”ç”¨çš„é…ç½®ä¸å…³äºWebpackçš„é…ç½®å‰¥ç¦»å¼€

é¡¹ç›®ä¸­å¼€å‘é…ç½®ä¸»è¦åœ¨dev-configç›®å½•ä¸‹ï¼Œå¦‚æœä½ è¦åŸºäºæœ¬é¡¹ç›®è¿›è¡ŒäºŒæ¬¡å¼€å‘,å¯ä»¥ç›´æ¥æ‹·è´dev-configä¸package.jsonåˆ°ä½ è‡ªå·±çš„é¡¹ç›®ä¸­,ç„¶åæ ¹æ®éœ€è¦é…ç½®dev-config/apps.config.jsé¡¹ç›®ã€‚è€Œä¸»è¦çš„åº”ç”¨é…ç½®ä¿¡æ¯ç›®å‰æ˜¯æŠ½è±¡åˆ°äº†`dev-config/app.config.js`æ–‡ä»¶ä¸­ï¼Œä¸»è¦çš„å¯é…ç½®é¡¹å¦‚ä¸‹:

```
/**
 * Created by apple on 16/6/8.
 */
const defaultIndexPage = "./dev-config/server/template.html";

module.exports = {
  apps: [
    //HelloWorld
    {
      id: "helloworld",
      src: "./src/simple/helloworld/helloworld.js",
      indexPage: defaultIndexPage,
      compiled: false //æ§åˆ¶åœ¨æ‰§è¡Œnpm run buildæ—¶æ˜¯å¦ä¼šç¼–è¯‘è¯¥app
    },
    {
      id: "react",
      src: "./src/react/react_app.js",
      indexPage: defaultIndexPage,
      compiled: true
    },
    {
      id: "redux",
      src: "./src/redux/redux_app.js",
      indexPage: defaultIndexPage,
      compiled: false
    }
  ],

  //å¼€å‘æœåŠ¡å™¨é…ç½®
  devServer: {
    appEntrySrc: "./src/react/react_app.js", //å½“å‰å¾…è°ƒè¯•çš„APPçš„å…¥å£æ–‡ä»¶
    port: 3000 //ç›‘å¬çš„Serverç«¯å£
  },

  //ä¾èµ–é¡¹é…ç½®
  proxy: {
    //åç«¯æœåŠ¡å™¨åœ°å€ http://your.backend/
    backend: "",
  },

  //å¦‚æœæ˜¯ç”Ÿæˆçš„ä¾èµ–åº“çš„é…ç½®é¡¹
  library: {
    name: "library_portal",//ä¾èµ–é¡¹å…¥å£å
    entry: "./src/library/library_portal.js",//ä¾èµ–åº“çš„å…¥å£,
    libraryName: "libraryName",//ç”Ÿæˆçš„æŒ‚è½½åœ¨å…¨å±€ä¾èµ–é¡¹ä¸‹é¢çš„åç§°
    libraryTarget: "var"//æŒ‚è½½çš„å…¨å±€å˜é‡å
  }
};
```

ï¼ˆ2ï¼‰èƒ½å¤Ÿä»¥å¹³æ»‘çš„æ–¹å¼ç¼–è¯‘ä¸ºä¸‰ä¸ªä¸åŒçš„ç›®æ ‡ï¼Œä¸»è¦æ˜¯ç‹¬ç«‹éƒ¨ç½²ï¼ˆå¾€å¾€ä½œä¸ºå•é¡µåº”ç”¨æˆ–è€…ç¦»çº¿WebAPPï¼‰ä¸Server Side Renderingè¿™ä¸¤ç§ã€‚

## Simple

> ç¬”è€…æ­£åœ¨é€æ­¥é‡‡ç”¨[yarn](https://github.com/wxyyxc1992/Web-Develop-Introduction-And-Best-Practices/blob/master/Server/NodeJS/Yarn.md)ä½œä¸ºæ›¿ä»£npmçš„ä¾èµ–ç®¡ç†å·¥å…·ï¼Œä¸è¿‡åœ¨ç›®å‰çš„READMEä¸­è¿˜æ˜¯ä¿ç•™äº†npmæ–¹å¼ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥è‡ªå·±è¿›è¡Œå°è¯•ã€‚

é¦–å…ˆä½¿ç”¨`git clone`å‘½ä»¤å°†é¡¹ç›®Cloneåˆ°æœ¬åœ°:

```
git clone https://github.com/wxyyxc1992/Webpack2-React-Redux-Boilerplate
cd Webpack2-React-Redux-Boilerplate
```

ç„¶åä½¿ç”¨ `npm install` / `npm link`å‘½ä»¤å®‰è£…ä¾èµ–é¡¹ç›®ï¼ŒåŒæ—¶å¦‚æœä½ è¦å®ç°éƒ¨ç½²çš„è¯è¿˜éœ€è¦ä¸€äº›å…¨å±€å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨`sh install.sh`è¿›è¡Œå®‰è£…ã€‚ç„¶åå°†`dev-config/app.config.js`ä½œå¦‚ä¸‹é…ç½®:

```
  //å¼€å‘æœåŠ¡å™¨é…ç½®
  devServer: {
    appEntrySrc: "./src/simple/helloworld/helloworld.js", //å½“å‰å¾…è°ƒè¯•çš„APPçš„å…¥å£æ–‡ä»¶
    port: 3000 //ç›‘å¬çš„Serverç«¯å£
  },
```

ç„¶åä½¿ç”¨`npm start`å‘½ä»¤å¯åŠ¨è°ƒè¯•æœåŠ¡å™¨ï¼Œæ­¤æ—¶åœ¨å‘½ä»¤è¡Œä¸­Webpack DashBoardä¼šè‡ªåŠ¨è¾“å‡ºç¼–è¯‘ä¿¡æ¯:

![](https://coding.net/u/hoteam/p/Cache/git/raw/master/2016/10/2/D78DFC34-9668-4FF1-8E80-8AD7CB82B686.png)

ç„¶ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€[http://localhost:3000](http://localhost:3000)ï¼Œä½ å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç”»é¢ï¼š

![](https://coding.net/u/hoteam/p/Cache/git/raw/master/2016/10/2/14890568-05F2-475F-9E02-D9DA45E8B0F1.png)

æ­¤æ—¶åœ¨ç¼–è¾‘å™¨ä¸­å®æ—¶ä¿®æ”¹App.jsï¼Œç»“æœå¯ä»¥é€šè¿‡çƒ­åŠ è½½å®æ—¶åé¦ˆåˆ°ç•Œé¢ä¸Šï¼Œçƒ­åŠ è½½ä¸»è¦æ˜¯åˆ©ç”¨å®æ—¶ä¼ é€æè¿°çƒ­åŠ è½½çš„jsonä¸jsæ–‡ä»¶:
![](https://coding.net/u/hoteam/p/Cache/git/raw/master/2016/10/2/1AE31998-054B-4AB2-A28A-513D242963AE.png)

è¿™æ ·å½“æˆ‘ä»¬æœ‰éœ€è¦è‡ªå®šä¹‰æŸäº›çƒ­åŠ è½½çš„è§„åˆ™æ—¶å¯ä»¥åŒæ ·åˆ©ç”¨è¿™ç§æ–¹å¼ã€‚æˆ‘ä»¬é€šè¿‡`npm start`åˆ©ç”¨WebpackDevServeræ¥å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œè¿™ä¸ªå¾ˆæ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œå¼€å‘ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡`npm run build`å‘½ä»¤æ¥æ„å»ºå¯å‘å¸ƒç‰ˆæœ¬ï¼Œè¿™ç§æ–¹å¼ç¼–è¯‘å¾—å‡ºçš„åŸºäºhashHistoryï¼Œå¯ä»¥ç”¨äºå•é¡µåº”ç”¨ï¼ˆè·¯å¾„ä¸å˜ï¼‰æˆ–è€…ç¦»çº¿åº”ç”¨ï¼ˆè­¬å¦‚åº”ç”¨åˆ°Cordovaä¸­ï¼‰ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨`dev-config/apps.config.js`ä¸­å°†ç›®æ ‡åº”ç”¨ç¼–è¯‘çŠ¶æ€è®¾ç½®ä¸ºtrueã€‚æ³¨æ„ï¼Œå¦‚æœåŒæ—¶ç¼–è¯‘å¤šä¸ªåº”ç”¨ï¼Œé‚£ä¹ˆCommonsChunkPluginä¼šå°†è¿™å‡ ä¸ªåº”ç”¨ä¸­çš„å…¬å…±ä»£ç æŠ½å–å‡ºæ¥:

```
    //HelloWorld
    {
      id: "helloworld",
      src: "./src/simple/helloworld/helloworld.js",
      indexPage: defaultIndexPage,
      compiled: true //æ§åˆ¶åœ¨æ‰§è¡Œnpm run buildæ—¶æ˜¯å¦ä¼šç¼–è¯‘è¯¥app
    },
```

![](https://coding.net/u/hoteam/p/Cache/git/raw/master/2016/10/2/6AE32545-2A26-43F0-B184-C2EA41297FB6.png)

ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€`helloworld.html`æ–‡ä»¶ï¼Œå³å¯çœ‹åˆ°ä¸åˆšæ‰çƒ­åŠ è½½æ—¶ç›¸åŒçš„é¡µé¢ã€‚å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œä½¿ç”¨çš„HTMLæ¨¡æ¿éƒ½æ˜¯ç»Ÿä¸€æ”¾ç½®äº`dev-config/server/template.html`æ–‡ä»¶ï¼Œç¬”è€…å»ºè®®ä½¿ç”¨[Helmet](https://github.com/nfl/react-helmet)æ¥ä¸ºHTMLæ·»åŠ è‡ªå®šä¹‰çš„å…ƒæ ‡ç­¾æˆ–è€…æ ·å¼è„šæœ¬ç­‰ã€‚

### Library

ä»¥ä¸Šè¿°æ–¹å¼ç¼–è¯‘çš„æ˜¯ç‹¬ç«‹å¯è¿è¡Œçš„è„šæœ¬ï¼Œè€Œåœ¨æœ‰äº›æƒ…å†µä¸‹æˆ‘ä»¬å¸Œæœ›ä»¥ç±»ä¼¼äºjQueryçš„æ–¹å¼æŒ‚è½½å…¨å±€å˜é‡/å‡½æ•°çš„æ–¹å¼ä½¿ç”¨éƒ¨åˆ†åŠŸèƒ½ï¼Œè¿™é‡Œæˆ‘ä»¬å°±éœ€è¦å°†ç¼–è¯‘ç›®æ ‡è®¾ç½®ä¸ºLibraryã€‚é¦–å…ˆå°†`dev-config/apps.config.js`ä¸­Libraryé…ç½®å¦‚ä¸‹:

```
  //å¦‚æœæ˜¯ç”Ÿæˆçš„ä¾èµ–åº“çš„é…ç½®é¡¹
  library: {
    name: "library_portal",//ä¾èµ–é¡¹å…¥å£å
    entry: "./src/simple/library/library_portal.js",//ä¾èµ–åº“çš„å…¥å£,
    libraryName: "libraryName",//ç”Ÿæˆçš„æŒ‚è½½åœ¨å…¨å±€ä¾èµ–é¡¹ä¸‹é¢çš„åç§°
    libraryTarget: "var"//æŒ‚è½½çš„å…¨å±€å˜é‡å
  }
```

ç„¶åä½¿ç”¨`npm run build:library`è¿›è¡Œç¼–è¯‘ï¼Œè¿™é‡Œæˆ‘ä»¬å¸Œæœ›å°†æŸä¸ªç®€å•çš„ES6ç±»å¯¼å‡ºåˆ°é¡µé¢ä¸­ä½¿ç”¨:

```
/**
 * @function åŸºäºES6çš„æœåŠ¡ç±»
 */
export class FooService {

    static echo(){

        const fooService = new FooService();

        return fooService.getMessage();
    }

    /**
     * @function é»˜è®¤æ„é€ å‡½æ•°
     */
    constructor() {
        this.message = "This is Message From FooService!";
    }

    getMessage() {
        return this.message;
    }

}
```

æˆ‘ä»¬è¿˜éœ€è¦è®¾ç½®ä¸“é—¨çš„å…¥å£æ–‡ä»¶:

```
/**
 * Created by apple on 16/7/23.
 */
import {FooService} from "./foo";

/**
 * @function é…ç½®éœ€è¦æš´éœ²çš„API
 * @type {{foo: {echo: FooService.echo}}}
 */
module.exports = {

    foo: {
        echo: FooService.echo
    }

};
```

ç„¶ååœ¨éœ€è¦çš„é¡µé¢ä¸­å¼•å…¥ç¼–è¯‘å¥½çš„ä¸¤ä¸ªè„šæœ¬:

```
<script src="../../../dist/vendors.bundle.js"></script>
<script src="../../../dist/library_portal.library.js"></script>
```

æ­¤æ—¶æ‰“å¼€è¯¥ç•Œé¢ï¼Œå³å¯ä»¥å¼¹å‡ºå¦‚ä¸‹çª—å£:

![](https://coding.net/u/hoteam/p/Cache/git/raw/master/2016/10/2/50EC5FF2-DFAA-43EF-A0E3-43070275C5EC.png)



## Server Side Rendering Support

æœ¬éƒ¨åˆ†æˆ‘ä»¬ä½¿ç”¨react_appè¿™ä¸ªåº”ç”¨ä½œä¸ºç¤ºä¾‹ï¼Œé¦–å…ˆåŒæ ·å°†é…ç½®ä¸­è°ƒè¯•ç›®æ ‡è®¾ç½®ä¸ºreact_app.js:

```
  //å¼€å‘æœåŠ¡å™¨é…ç½®
  devServer: {
    appEntrySrc: "./src/react/react_app.js", //å½“å‰å¾…è°ƒè¯•çš„APPçš„å…¥å£æ–‡ä»¶
    port: 3000 //ç›‘å¬çš„Serverç«¯å£
  },
```

ç„¶åä½¿ç”¨`npm start`å‘½ä»¤æ¥å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œç„¶ååŒæ ·å¯ä»¥ä½¿ç”¨`npm run build`å‘½ä»¤ç¼–è¯‘å¯å‘å¸ƒç‰ˆæœ¬ã€‚ç„¶åæ‰“å¼€`dist/`ç›®å½•ä¸‹çš„`react.html`æ–‡ä»¶ï¼Œå³å¯ä»¥çœ‹åˆ°ç•Œé¢ï¼Œæ³¨æ„ï¼Œæ­¤æ—¶ä½¿ç”¨çš„æ˜¯hashHistoryï¼Œå› æ­¤URLçš„å½¢å¼ä¸º:

```
react.html?_ijt=4t0fmg7f6rhsv85efsau6j3t1r#/detail?_k=f9r3og
```

ç„¶åæˆ‘ä»¬éœ€è¦ä»¥Server Side Renderingçš„æ–¹å¼å‘å¸ƒé¡¹ç›®ï¼Œå…¶ä¸»è¦åŒºåˆ«åœ¨äºæ”¯æŒbrowserHistoryä»¥åŠæœåŠ¡ç«¯å®Œæˆæ¸²æŸ“ã€‚æ³¨æ„ï¼Œå®é™…ä¸Šé¡µé¢å‘é€åˆ°å®¢æˆ·ç«¯ä¹‹åè¿˜ä¼šä¾é åŠ è½½çš„JSè„šæœ¬å…¨éƒ¨é‡æ–°æ¸²æŸ“ï¼Œå…¶åªæ˜¯ä¸ºäº†æ–¹ä¾¿SEO/é¦–å±æ˜¾ç¤ºé€Ÿåº¦/å¡«å……åˆå§‹çŠ¶æ€åˆ°ç•Œé¢ä¸­ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†`apps.config.js`æ–‡ä»¶ä¸­çš„ssrServeré¡¹ç›®è®¾ç½®ä¸ºæˆ‘ä»¬ç›®æ ‡çš„ssrServer:

````
  //ç”¨äºæœåŠ¡ç«¯æ¸²æŸ“çš„Serverè·¯å¾„
  ssrServer: {
    serverEntrySrc: './src/react/ssr_server.js'
  },
````

æˆ‘ä»¬ä½¿ç”¨`npm run build:ssr`å‘½ä»¤è¿›è¡Œç¼–è¯‘ï¼Œåœ¨`dist`ç›®å½•ä¸‹å¯ä»¥å¾—åˆ°å¦‚ä¸‹æ–‡ä»¶:

```
.
â”œâ”€â”€ react.bundle.js
â”œâ”€â”€ react.css
â”œâ”€â”€ react.html
â”œâ”€â”€ ssr_server.bundle.js
â”œâ”€â”€ ssr_server.bundle.js.map
â””â”€â”€ vendors.bundle.js
```

åœ¨æœ¬é¡¹ç›®ä¸­ä¸ºäº†å°½å¯èƒ½çš„ä»£ç å¤ç”¨ï¼Œä½¿ç”¨äº†å˜é‡æ¥æ§åˆ¶æ˜¯å¦æ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨` node dist/ssr_server.bundle.js`å³å¯ä»¥å¯åŠ¨æœåŠ¡å™¨ï¼Œæ­¤æ—¶URLæ ¼å¼ä¸º:

```
http://localhost:3001/login
```

## Lint

### Flow

### ESLint


# Develop Environment:å¼€å‘ç¯å¢ƒæœºåˆ¶è¯¦è§£

## Webpack2

> - [What's new in webpack 2](https://gist.github.com/sokra/27b24881210b56bbaff7)

æœ¬é¡¹ç›®ä¸­ä½¿ç”¨Webpack 2æ›¿ä»£åŸæœ¬çš„Webpack 1ï¼Œä»Webpack 1åˆ°Webpack 2å¾ˆå¤šçš„é…ç½®é¡¹ç›®å‘ç”Ÿäº†å˜åŒ–ï¼Œè¯¦ç»†åˆ—è¡¨å¯ä»¥å‚è€ƒå¼•ç”¨ä¸­æä¾›çš„é“¾æ¥ã€‚è€Œåœ¨æœ¬é¡¹ç›®ä¸­ï¼Œå…¶ä¸­å‡ ä¸ªå…¸å‹çš„ä¿®æ”¹ä¸º:
ï¼ˆ1ï¼‰æ‰€æœ‰loaderçš„é…ç½®æå–åˆ°äº†LoaderOptionsPluginä¸­ã€‚

```
  //æå–Loaderå®šä¹‰åˆ°åŒä¸€åœ°æ–¹
  new webpack.LoaderOptionsPlugin({
    minimize: true,
    debug: false,
    options: {
      context: '/',
      postcss: [
        utils.postCSSConfig
      ]
    }
  }),
```

è¿™é‡ŒåŒ…å«å¯¹äºåŸæœ¬çš„UglifyJsPluginä¸PostCSSçš„é…ç½®ã€‚

ï¼ˆ2ï¼‰loaderé…ç½®æ›´åŠ çµæ´»ã€‚

```
loaders: [
    {
        test: /\.css$/,
        loaders: [
            "style-loader",
            { loader: "css-loader", query: { modules: true } },
            {
                loader: "sass-loader",
                query: {
                    includePaths: [
                        path.resolve(__dirname, "some-folder")
                    ]
                }
            }
        ]
    }
]
```



## WebpackDevServer & Hot Loader

åœ¨å‰ä¸€ç‰ˆæœ¬çš„devServerä¸­ï¼Œç¬”è€…ä½¿ç”¨äº†expressåŠ ä¸Šwebpack-dev-middlewareä¸webpack-hot-middlewareä¸­é—´ä»¶ï¼Œæœ¬ç‰ˆæœ¬ä¸­æ˜¯è¿ç§»åˆ°äº†WebpackDevServer:

```
new WebpackDevServer(webpack(config), {
  //è®¾ç½®WebpackDevServerçš„å¼€å‘ç›®å½•
  contentBase: path.join(__dirname + "/"),
  // publicPath: `http://0.0.0.0:${appsConfig.devServer.port}/`,
  hot: true,
  historyApiFallback: true,
  quiet:true,
  // noInfo: true,
  stats: {colors: true}
}).listen(appsConfig.devServer.port, '0.0.0.0', function (err, result) {
  if (err) {
    return console.log(err);
  }

  console.log(`Listening at http://0.0.0.0:${appsConfig.devServer.port}/`);
});
```

å¦å¤–å°±æ˜¯å¯¹äºHotReloaderçš„ä½¿ç”¨ï¼Œç›®å‰å¾ˆå¤šçƒ­åŠ è½½çš„å®ç°æ–¹å¼è¿˜æ˜¯åŸºäº[react-transform](https://github.com/gaearon/react-transform-boilerplate)ï¼Œä¸è¿‡è¯¥é¡¹ç›®å·²ç»åºŸå¼ƒäº†ï¼Œå› æ­¤è¿™é‡Œå¦‚æœè¦è‡ªå·±æ·»åŠ çƒ­åŠ è½½ç»„ä»¶çš„è¯ï¼Œå»ºè®®ä½¿ç”¨[react-hot-loader](https://github.com/gaearon/react-hot-loader)ï¼Œç›®å‰ç¬”è€…ä½¿ç”¨äº†3.0ç‰ˆæœ¬ã€‚æˆ‘ä»¬åˆ†åˆ«éœ€è¦å°†ä¸Šé¢çš„WebpackDevServerä¸­çš„hotè®¾ç½®ä¸ºtrueï¼Œå¹¶ä¸”åœ¨Babelé…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®:

```
  "env": {
    "development": {
      "presets": [
        "react-hmre"
      ],
      "plugins": [
        "react-hot-loader/babel"
      ]
    }
  }
```

## API Proxy

å¾…è¡¥å……ã€‚

# React Router & Server Side Rendering

> - [Reactè·¯ç”±è§£å†³æ–¹æ¡ˆReact-Routerä»‹ç»ä¸å®è·µ](https://github.com/wxyyxc1992/Web-Develop-Introduction-And-Best-Practices/blob/master/Frontend/Framework/View/React/Router/React-Router.md)



## Pure Frontend 

æˆ‘ä»¬é¦–å…ˆä»åº”ç”¨çš„å…¥å£ç¨‹åºçœ‹èµ·:

```
let history;

//åˆ¤æ–­æ˜¯å¦ä¸ºSSRä»è€Œç¡®å®šåº”è¯¥é€‰ç”¨å“ªä¸ªHistory
if (__SSR__) {
  //å¦‚æœæ˜¯æµè§ˆå™¨ç¯å¢ƒ,åˆ™ä½¿ç”¨browserHistory
  history = browserHistory;
} else {
  //å¦‚æœæ˜¯ç‹¬ç«‹ç¯å¢ƒ,åˆ™ä½¿ç”¨hashHistory
  history = hashHistory;
}

//åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹ä½¿ç”¨hashHistory
const router = <Router history={history}>
  {getRoutes(localStorage)}
</Router>;

//å°†ç»„ä»¶æ¸²æŸ“åˆ°DOMä¸­
render(
  router,
  document.getElementById('root')
);
```

è¿™é‡Œå°†è·¯ç”±é…ç½®æå–åˆ°å•ç‹¬æ–‡ä»¶ä¸­ï¼Œæ˜¯å› ä¸ºè·¯ç”±é…ç½®æ˜¯éœ€è¦åœ¨æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯å…±äº«çš„ï¼Œå› æ­¤å°†å¯èƒ½æ˜¯DOMä¸‹ç‹¬æœ‰çš„localStorageæˆ–è€…ç±»ä¼¼çš„å¯¹è±¡ä»¥å‚æ•°æ–¹å¼ä¼ å…¥ã€‚å¯¹äºRouteçš„é…ç½®å€’æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¿æŒä¸€è‡´:

```
  return (
    <Route path="/" history={browserHistory} component={Container}>
      <IndexRoute component={Home}/>
      <Route path="home" component={withRouter(Home)}/>
      <Route path="login" component={withRouter(Login)}/>
      <Route path="detail" component={withRouter(Detail)} onEnter={auth}/>
    </Route>
  );
```

å…¶ä½™çš„ä»£ç ä¸å¤šï¼Œå¯ä»¥è‡ªè¡Œæµè§ˆæ•´ä¸ªé¡¹ç›®ã€‚è¿™é‡Œæœ‰ä¸ªå…³äºReact Routerçš„ç‚¹æˆ‘æƒ³è¯´æ˜ä¸‹,åœ¨Routeé…ç½®æ—¶ä½¿ç”¨`withRouter`è¿™ä¸ªæ–¹æ³•å¯ä»¥ä»¥HOCæ–¹å¼æ³¨å…¥routerå¯¹è±¡åˆ°Propsä¸­ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨è¿›è¡Œé¡µé¢è·³è½¬æ—¶å¯ä»¥ä½¿ç”¨:

```
this.props.router.goBack()
```



## Server Side Rendering

é¦–å…ˆæˆ‘ä»¬è¯´å‡ å¥åºŸè¯ï¼Œéœ€è¦äº†è§£æœåŠ¡ç«¯æ¸²æŸ“åˆ°åº•åšäº†å•¥:

ï¼ˆ1ï¼‰Serverç«¯åªè´Ÿè´£é¦–é¡µçš„æ¸²æŸ“ï¼Œå…¶ä»–é¡µé¢ä»ç„¶ç”±å®¢æˆ·ç«¯è¿›è¡Œæ¸²æŸ“ã€‚å³è™½ç„¶URL Pathå‘ç”Ÿäº†å˜åŒ–ï¼Œä½†æ˜¯å¹¶æœªè§¦å‘æ•´ä¸ªé¡µé¢çš„å®Œå…¨åˆ·æ–°ã€‚

ï¼ˆ2ï¼‰ä»¥Reduxä¸ºä»£è¡¨çš„çŠ¶æ€ç®¡ç†å·¥å…·ä¸­çš„Storeåªæ˜¯åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶å°†æ•°æ®ä¼ é€’ç»™å®¢æˆ·ç«¯ï¼Œåœ¨åç»­çš„é¡µé¢åˆ‡æ¢/è®¤è¯ç­‰æ“ä½œä¸­çš„æ‰€æœ‰ä»£ç çš†åœ¨å®¢æˆ·ç«¯è¿è¡Œã€‚

è¿™é‡Œæˆ‘ä»¬ä¸éœ€è¦æ”¹é€ ä¸Šé¢çš„å®¢æˆ·ç«¯å…¥å£æ–‡ä»¶ï¼Œè€Œéœ€è¦æ·»åŠ ä¸€ä¸ªç”¨äºæœåŠ¡ç«¯è¿è¡Œçš„æ–‡ä»¶ï¼Œå…¶æ ¸å¿ƒä»£ç ä¸º:

```
//å¤„ç†æ‰€æœ‰çš„è¯·æ±‚åœ°å€
app.get('/*', function (req, res) {

  //åŒ¹é…å®¢æˆ·ç«¯è·¯ç”±
  match({routes: getRoutes(), location:req.originalUrl}, (error, redirectLocation, renderProps) => {

    if (error) {

      res.status(500).send(error.message)

    } else if (redirectLocation) {

      res.redirect(302, redirectLocation.pathname + redirectLocation.search)

    } else if (renderProps) {

      let html = renderToString(<RouterContext {...renderProps} />);

      res.status(200).send(renderHTML(html, {key: "value"}, ['/static/vendors.bundle.js', '/static/react.bundle.js']));

    } else {
      res.status(404).send('Not found')
    }
  })
});
```

å¯ä»¥çœ‹å‡ºï¼Œå³æ˜¯ç”¨æˆ·é¦–æ¬¡å‘æœåŠ¡ç«¯å‘èµ·è¯·æ±‚æ—¶ï¼Œé¦–å…ˆå¯¹äºé¦–å±å±•ç¤ºçš„ç»„ä»¶è¿›è¡Œæ¸²æŸ“ã€‚æˆ‘ä»¬æ¥åšä¸€ä¸ªå¯¹æ¯”ï¼ŒæœåŠ¡ç«¯æ¸²æŸ“ä¹‹åçš„å¾—åˆ°çš„HTMLå­—ç¬¦ä¸²ä¸º:


```
<div data-reactroot="" data-reactid="1" data-react-checksum="663537196">
    <section class="login__container" data-reactid="2"><!-- react-text: 3 -->ç™»é™†ç•Œé¢<!-- /react-text -->
        <div data-reactid="4utton data-reactid=" 5
        ">ç‚¹å‡»ç™»é™†</button>
        <button data-reactid="6">ç‚¹å‡»ç™»å‡º</button>
</div></section></div>
```

è€ŒåŸå§‹çš„JSXç»„ä»¶å¦‚ä¸‹ï¼Œå¯ä»¥å‘ç°äº‹ä»¶å¤„ç†ç­‰å¾ˆå¤šä»£ç éƒ½è¢«è¿‡æ»¤äº†ã€‚

```
/**
 * Created by apple on 16/9/13.
 */
export class Login extends Component {

  /**
   * @function é»˜è®¤æ¸²æŸ“å‡½æ•°
   * @return {XML}
   */
  render() {
    return <section className="login__container">
      ç™»é™†ç•Œé¢

      <div>
        <button onClick={()=> {
          //å°†ç™»é™†ä¿¡æ¯å†™å…¥cookiesä¸localStorage
          login().then(()=> {
            //ç™»é™†æˆåŠŸè·³è½¬åˆ°è¯¦æƒ…é¡µ
            this.props.router.push('/detail');
          });
        }}>
          ç‚¹å‡»ç™»é™†
        </button>

        <button onClick={()=> {
          //å°†ç™»é™†ä¿¡æ¯å†™å…¥cookiesä¸localStorage
          logout();
          //ç™»é™†æˆåŠŸè·³è½¬åˆ°è¯¦æƒ…é¡µ
          this.props.router.push('/');
        }}>
          ç‚¹å‡»ç™»å‡º
        </button>
      </div>

    </section>
  }
}
```

## Authentication

æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹æŸäº›URLæ·»åŠ æƒé™è®¤è¯ï¼Œå³åªå…è®¸è®¤è¯ç”¨æˆ·æ‰èƒ½è®¿é—®ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Routeä¸­çš„onEnterå±æ€§è¿›è¡Œæ§åˆ¶:

```
<Route path="detail" component={withRouter(Detail)} onEnter={auth}/>
```

è€Œæˆ‘ä»¬åœ¨ä¸Šæ–‡ä¸­ä¼ å…¥çš„Storeå¯¹è±¡ä¹Ÿæ˜¯åœ¨è¿™ä¸ªæ—¶å€™æ´¾ä¸Šç”¨åœº:

```
/**
   * @function åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†,å¦‚æœæœªç™»é™†åˆ™å¼ºåˆ¶æ€§è·³è½¬åˆ°ç™»å½•é¡µé¢
   * @param nextState
   * @param replace
   * @param callback
   */
  async function auth(nextState, replace, callback) {

    let userToken = store.userToken;

    //åœ¨è¿™é‡Œæ‰§è¡Œå¼‚æ­¥è®¤è¯,å‡è®¾ä¼ å…¥çš„storeä¸­åŒ…å«userToken
    //è¿™é‡Œä½¿ç”¨Promiseæ‰§è¡Œå¼‚æ­¥æ“ä½œ
    //å¦‚æœæ˜¯SSR,åˆ™æœ¬éƒ¨åˆ†ä»£ç ä¼šåœ¨æœåŠ¡ç«¯è¿è¡Œ

    let isValid = await valid_user(userToken);

    //å¦‚æœç”¨æˆ·å°šæœªè®¤è¯,åˆ™è¿›è¡Œè·³è½¬æ“ä½œ
    isValid || replace('/login');

    //æ‰§è¡Œå›è°ƒå‡½æ•°
    callback();

  }
```



# Isomorphic Redux

ç¬”è€…ç›®å‰åœ¨è‡ªå·±ä¸»å¯¼çš„å‡ ä¸ªå‰ç«¯é¡¹ç›®ä¸­æ¸æ¸çš„è½¬å‘MobXä¸Reduxå¹¶è¡Œ.æœ¬é¡¹ç›®ä¸­å¯¹äºReduxçš„æ–‡ä»¶å¸ƒå±€é‡‡å–çš„æ˜¯[Ducks](https://github.com/erikras/ducks-modular-redux)è¿™ç§æ–¹å¼,å‚è€ƒäº†[my-journey-toward-a-maintainable-project-structure-for-react-redux](https://hackernoon.com/my-journey-toward-a-maintainable-project-structure-for-react-redux-b05dfd999b5#.yot2mml9t)ä¸€æ–‡ã€‚å³æŒ‰ç…§ç‰¹æ€§æ¥å°†Reducersã€ActionCreatorsã€Actionsã€Selectorsé›†ä¸­åˆ°å•ä¸ªæ–‡ä»¶ä¸­:
```
// src/ducks/auth.js
const AUTO_LOGIN = 'AUTH/AUTH_AUTO_LOGIN'
const SIGNUP_REQUEST = 'AUTH/SIGNUP_REQUEST'
const SIGNUP_SUCCESS = 'AUTH/SIGNUP_SUCCESS'
const SIGNUP_FAILURE = 'AUTH/SIGNUP_FAILURE'
const LOGIN_REQUEST = 'AUTH/LOGIN_REQUEST'
const LOGIN_SUCCESS = 'AUTH/LOGIN_SUCCESS'
const LOGIN_FAILURE = 'AUTH/LOGIN_FAILURE'
const LOGOUT = 'AUTH/LOGOUT'

const initialState = {
  user: null,
  isLoading: false,
  error: null
}

export default (state = initialState, action) => {
  switch (action.type) {
    case SIGNUP_REQUEST:
    case LOGIN_REQUEST:
      return { ...state, isLoading: true, error: null }

    case SIGNUP_SUCCESS:
    case LOGIN_SUCCESS:
      return { ...state, isLoading: false, user: action.user }

    case SIGNUP_FAILURE:
    case LOGIN_FAILURE:
      return { ...state, isLoading: false, error: action.error }

    case LOGOUT:
      return { ...state, user: null }

    default:
      return state
  }
}

export const signup = (email, password) => ({ type: SIGNUP_REQUEST, email, password })
export const login = (email, password) => ({ type: LOGIN_REQUEST, email, password })
export const logout = () => ({ type: LOGOUT })
```

å¯¹äº[Redux Dev Tools](https://github.com/gaearon/redux-devtools#browser-extension),è¯·è‡ªè¡Œä½¿ç”¨[Browser Extension]()ã€‚

## Simple Count 

æˆ‘ä»¬é¦–å…ˆä»¥ç®€å•çš„åŸºäºReduxçš„è®¡æ•°å™¨ä¸ºä¾‹ï¼Œå°†`dev-config/apps.config.js`ä¸­çš„å¼€å‘é…ç½®è®¾ç½®ä¸ºå¦‚ä¸‹:

```
  //å¼€å‘æœåŠ¡å™¨é…ç½®
  devServer: {
    appEntrySrc: "./src/redux/redux_app.js", //å½“å‰å¾…è°ƒè¯•çš„APPçš„å…¥å£æ–‡ä»¶
    port: 3000 //ç›‘å¬çš„Serverç«¯å£
  },
```

ç„¶åä½¿ç”¨`npm start`è¿è¡Œå¼€å‘æœåŠ¡å™¨ï¼Œç•Œé¢ä¸Šçš„å¦‚ä¸‹è¡¨ç¤ºå³ä¸ºè¯¥ç¤ºä¾‹:

![](https://coding.net/u/hoteam/p/Cache/git/raw/master/2016/10/2/1FB65E46-3771-4A87-B217-6181A502945A.png)

åœ¨Redux DevToolsä¸­ï¼Œçº¢è‰²æ¡†çº¿æ ‡ç¤ºå‡ºçš„å³ä¸ºcountç›¸å…³çš„çŠ¶æ€ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥ç®€å•æè¿°ä¸‹å…¶æ ¸å¿ƒä»£ç ã€‚åœ¨Reduxå¼€å‘ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ„å»ºä¸€ä¸ªDucksï¼Œå³åŒ…å«Actionã€ActionCreatorä¸Reducer:

```
/**
 * Created by apple on 16/10/11.
 */
// no changes here ğŸ˜€

/**
 * @function å®šä¹‰Actions
 * @type {string}
 */
export const INCREMENT_COUNT = 'INCREMENT';

export const DECREMENT_COUNT = 'DECREMENT';

/**
 * @function å®šä¹‰Reducer
 * @param state
 * @param action
 * @return {number}
 */
export default (state = 0, {type}) => {
  switch (type) {
    case INCREMENT_COUNT:
      return state + 1;
    case DECREMENT_COUNT:
      return state - 1;
    default:
      return state
  }
}

/**
 *@region å®šä¹‰Action Creator
 */

/**
 * @function è§¦å‘åŠ 1æ“ä½œ
 * @return {{type: string}}
 */
export const increment = ()=> {

  return {
    type: INCREMENT_COUNT
  }

};

/**
 * @function åœ¨è¿™é‡Œè¿›è¡Œå¼‚æ­¥åŠ 1æ“ä½œ
 * @return {function(*)}
 */
export const incrementAsync = ()=> {

  return dispatch => {
    setTimeout(() => {
      // Yay! Can invoke sync or async actions with `dispatch`
      dispatch(increment());
    }, 1000);
  };
};

/**
 * @function æ‰§è¡Œè®¡æ•°å™¨å‡ä¸€æ“ä½œ
 * @return {{type: string}}
 */
export const decrement = ()=> {

  return {
    type: DECREMENT_COUNT
  }

};
```

è¿™é‡Œä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬æ˜¯ä½¿ç”¨äº†redux-thunkæ¥å¤„ç†å¼‚æ­¥Actionï¼Œå®é™…ä¸Šåœ¨Reduxä¸­å¯¹äºå¼‚æ­¥Actionçš„å¤„ç†ä¹Ÿæœ‰å„ç§å„æ ·çš„å®è·µï¼ŒåŒ…æ‹¬ç¬”è€…åœ¨è¿™é‡Œè‡ªå®šä¹‰çš„promiseMiddlewareï¼Œä¹Ÿæ˜¯ä¸€ç§æ–¹å¼ã€‚ç„¶åæˆ‘ä»¬éœ€è¦æ„å»ºä¸€ä¸ªStoreæ¥å­˜æ”¾å…¨å±€çš„çŠ¶æ€ï¼ŒStoreæœ¬èº«æ˜¯åŸºäºReduceræ¥é€’å½’ç”ŸæˆçŠ¶æ€æ ‘çš„,å…¶æ ¸å¿ƒä»£ç å¦‚ä¸‹:

```
  const store = createStoreWithMiddleware(
    rootReducer,
    initialState,
    typeof window === 'object' && typeof window.devToolsExtension !== 'undefined' && __DEV__ ? window.devToolsExtension() : f => f);

  /**
   * @function ä¿è¯Redux Reducerçš„çƒ­åŠ è½½
   */
  if (__DEV__ && module.hot) {
    module.hot.accept('./reducer', () => {
      //æ›¿æ¢Storeä¸­çš„Reducer
      store.replaceReducer(require('./reducer'));
    })
  }
```

ç°åœ¨æˆ‘ä»¬å·²ç»å†™å®Œäº†Reduxéƒ¨åˆ†çš„ä»£ç ï¼Œä¸‹é¢å°±æ˜¯éœ€è¦å°†çŠ¶æ€å¯¼å…¥åˆ°ç•Œé¢ä¸­:

```
@connect(
  state => ({
    count: state.count
  }),
  {pushState: push, increment, incrementAsync, decrement}
)
export class Home extends Component {
  render() {

    //åœ¨éSSRçŠ¶æ€ä¸‹å¯¼å…¥SCSSæ–‡ä»¶
    __SSR__ || require('./home.scss');

    const {count, pushState, increment, incrementAsync, decrement} = this.props;

    return <section className="home__container">

      <div>
        ç‹ä¸‹é‚€æœˆç†Š Webpack2-React-Redux-Boilerplate
      </div>

      <br/>
      <br/>

      <div>å¯¼èˆªæ ç›®:</div>

      <li>
        <button onClick={()=> {
          pushState('/detail')
        }}>
          è¯¦æƒ…é¡µ(éœ€è¦å…ˆè¿›è¡Œç™»é™†æ“ä½œ)
        </button>
      </li>
      <li><Link to="/login">ç™»é™†é¡µ</Link></li>

      <br/>
      <br/>

      <div>åŸºäºReduxçš„Countå®ä¾‹</div>
      <div>{count}</div>
      <div>
        <button onClick={increment}>åŠ 1</button>
        <button onClick={incrementAsync}>å¼‚æ­¥åŠ 1</button>
        <button onClick={decrement}>å‡1</button>
      </div>

    </section>
  }
}
```



## [React Router Redux](https://github.com/reactjs/react-router-redux)

React Router Reduxçš„ä»£ç è¿˜æ˜¯ç®€å•æ˜“æ‡‚çš„,å…¶åªæ˜¯åœ¨ç”¨æˆ·ç‚¹å‡»/è·³è½¬ä¸React Routerè‡ªèº«çš„Historyä¹‹é—´åŠ ä¸Šäº†ä¸€å±‚å°è£…

> [history](https://github.com/reactjs/history)Â +Â `store`Â ([redux](https://github.com/reactjs/redux)) â†’Â [**react-router-redux**](https://github.com/reactjs/react-router-redux)Â â†’ enhancedÂ [history](https://github.com/reactjs/history)Â â†’Â [react-router](https://github.com/reactjs/react-router)

å¦‚æœä½ éœ€è¦è‡ªå®šä¹‰å…¶ä»–çš„Location,è­¬å¦‚å¦‚æœä½ éœ€è¦å¼•å…¥ImmutableJSä½œä¸ºStore:
```
import Immutable from 'immutable';
import {
    LOCATION_CHANGE
} from 'react-router-redux';

let initialState;

initialState = Immutable.fromJS({
    locationBeforeTransitions: undefined
});

export default (state = initialState, action) => {
    if (action.type === LOCATION_CHANGE) {
        return state.merge({
            locationBeforeTransitions: action.payload
        });
    }

    return state;
};
```
## SSR

ä¸ä¸Šæ–‡ä¸­çš„Server Side Rendering Serverç›¸æ¯”ï¼Œå…¶æ·»åŠ äº†å¯¹äºçŠ¶æ€ä¼ é€’çš„æ”¯æŒ:

```

//å¤„ç†æ‰€æœ‰çš„è¯·æ±‚åœ°å€
app.get('/*', function (req, res) {

  //æ„å»ºå‡ºå†…å­˜ä¸­å†å²è®°å½•
  const memoryHistory = createHistory(req.originalUrl);

  //æœåŠ¡ç«¯æ„å»ºå‡ºStore
  const store = createStore(memoryHistory);

  //æ„å»ºå‡ºä¸StoreåŒæ­¥çš„history
  const history = syncHistoryWithStore(memoryHistory, store);

  //åŒ¹é…å®¢æˆ·ç«¯è·¯ç”±
  match({history, routes: getRoutes(), location: req.originalUrl}, (error, redirectLocation, renderProps) => {

    if (error) {

      res.status(500).send(error.message)

    } else if (redirectLocation) {

      res.redirect(302, redirectLocation.pathname + redirectLocation.search)

    } else if (renderProps) {

      let html = renderToString(
        <Provider store={store}>
          <RouterContext {...renderProps} />
        </Provider>
      );

      //è®¾ç½®å…¨å±€çš„navigatorå€¼
      // global.navigator = {userAgent: req.headers['user-agent']};

      res.status(200).send(renderHTML(html, {key: "value"}, ['/static/vendors.bundle.js', '/static/redux.bundle.js']));

    } else {
      res.status(404).send('Not found')
    }
  })
});
```




> æ¬¢è¿å¤§å®¶æŒ‡å¯¼ä¸è®¨è®º,åŒæ—¶å†æ¬¡å»ºè®®,åœ¨ä¸èƒ½æŒæ¡æœ¬é¡¹ç›®çš„æƒ…å†µæ…é‡ç›´æ¥ç”¨äºå¤§å‹é¡¹ç›®ä¸­,å¯¹è‡ªå·±è´Ÿè´£ã€‚